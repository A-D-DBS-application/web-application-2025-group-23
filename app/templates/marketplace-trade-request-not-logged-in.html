{% extends "base.html" %}
{% block title %}{{ service.title }} - Marketplace | Barter.com{% endblock %}
{% block nav_marketplace_active %}class="active"{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='tradeflow.css') }}">

<div class="tradeflow-container">
    <!-- Main Content - Full Width -->
    <main class="main main-full-width">
        <div class="mb-24">
            <a href="{{ url_for('main.marketplace_public') }}" class="link-back text-decoration-none">← Back to marketplace</a>
        </div>
        
        <div class="page-header">
            <h1 class="page-title">{{ service.title }}</h1>
            <p class="page-subtitle mt-8">offered by {{ service.company.name if service.company else 'Unknown Company' }}</p>
        </div>
        
        <div class="service-form">
            <div class="form-field form-field--full">
                <label>Service Title</label>
                <div class="form-display-box">
                    {{ service.title }}
                </div>
            </div>

            <div class="form-field form-field--full">
                <label>Description</label>
                <div class="form-display-box form-display-box--tall">
                    {{ service.description or 'No description' }}
                </div>
            </div>

            <div class="form-field form-field--full">
                <label>Duration (hours)</label>
                <div class="form-display-box">
                    {{ service.duration_hours }}
                </div>
            </div>

            <div class="form-field form-field--full">
                <label>Categories</label>
                <div class="category-grid">
                    {% if service.categories %}
                        {% for cat in service.categories.split(',') %}
                            <div class="category-item category-item--disabled">
                                <input type="checkbox" id="cat_{{ loop.index }}" checked disabled>
                                <label for="cat_{{ loop.index }}">{{ cat.strip() }}</label>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-box">
                            No categories selected
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="form-field form-field--full">
                <label>Reviews</label>
                {% if reviews and reviews|length > 0 %}
                    <div class="d-flex flex-column gap-12">
                        {% for review in reviews %}
                        <div class="review-card-inline">
                            <div class="review-card-inline__header">
                                <span class="review-card-inline__author">{{ review.reviewer.username if review.reviewer else 'Anonymous' }}</span>
                                <div class="review-card-inline__meta">
                                    <div class="review-card-inline__rating">
                                        {% for i in range(review.rating) %}★{% endfor %}
                                        {% for i in range(5 - review.rating) %}☆{% endfor %}
                                    </div>
                                    <span class="review-card-inline__date">{{ review.created_at.strftime('%B %d, %Y') if review.created_at else '' }}</span>
                                </div>
                            </div>
                            <p class="review-card-inline__comment">{{ review.comment }}</p>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="empty-box">
                        No reviews yet for this service
                    </div>
                {% endif %}
            </div>

            <!-- Disabled Send Trade Request Button -->
            <button type="button" disabled class="btn-cta-full btn-cta-full--disabled mt-24">Send Trade Request</button>
            
            <!-- Login/Register Notice -->
            <div class="mt-24">
                {% if is_logged_in %}
                <p class="info-notice">You need to be part of a company to send trade requests. Create or join a company to start trading services on Barter.com</p>
                <a href="{{ url_for('main.create_company') }}" class="btn-cta-full btn-cta-full--primary mb-12">Create company</a>
                <a href="{{ url_for('main.join_company') }}" class="btn-cta-full btn-cta-full--primary">Join company</a>
                {% else %}
                <p class="info-notice">You must be logged in to send a trade request. Log in or create an account to start trading services on Barter.com</p>
                <a href="{{ url_for('main.login') }}" class="btn-cta-full btn-cta-full--primary mb-12">Log in</a>
                <a href="{{ url_for('main.register') }}" class="btn-cta-full btn-cta-full--primary">Create an Account</a>
                {% endif %}
            </div>
        </div>
    </main>
</div>
{% endblock %}
