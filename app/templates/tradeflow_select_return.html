{% extends "base.html" %}
{% block title %}Select Return Service ‚Äì Barter.com{% endblock %}
{% block nav_tradeflow_active %}class="active"{% endblock %}
{% set active_page = 'incoming' %}

{% block content %}
<div class="tradeflow-container">
  {% include '_tradeflow_sidebar.html' %}

  <main class="main">
    <div class="page-header">
      <div class="page-header-content">
        <h1 class="page-title">Select return service</h1>
        <p class="page-desc">{{ incoming_request.requesting_company.name }} is interested in your <strong>{{ incoming_request.requested_service.title }}</strong></p>
      </div>
      <form method="POST" action="{{ url_for('main.tradeflow_decline_request', company_id=company.company_id, request_id=incoming_request.request_id) }}" style="margin-top: 4px;">
        <button type="submit" class="decline-btn">Decline</button>
      </form>
    </div>

    <div class="info-box">
      <div class="info-box-label">They want</div>
      <div class="info-box-title">{{ incoming_request.requested_service.title }}</div>
      <div class="info-box-desc">{{ incoming_request.requested_service.description[:100] }}{% if incoming_request.requested_service.description|length > 100 %}...{% endif %}</div>
    </div>

    {% if services %}
    <div class="cards-grid">
      {% for service in services %}
      <a href="{{ url_for('main.tradeflow_select_return_detail', company_id=company.company_id, request_id=incoming_request.request_id, service_id=service.service_id) }}" class="card">
        <div class="card-company">RETURN SERVICE</div>
        <div class="card-title">{{ service.title }}</div>
        <div class="card-desc">{{ service.description[:70] }}{% if service.description|length > 70 %}...{% endif %}</div>
        <div class="card-meta">
          <span>‚è± {{ service.duration_hours }} hrs</span>
        </div>
        {% if service.categories %}
        <div class="card-categories">
          {% for cat in service.categories.split(',') %}
            <span class="card-category-tag">{{ cat.strip() }}</span>
          {% endfor %}
        </div>
        {% endif %}
      </a>
      {% endfor %}
    </div>
    {% else %}
    <div class="empty">
      <div class="empty-icon">üö´</div>
      <div class="empty-text">You don't have any services available.</div>
    </div>
    {% endif %}
  </main>
</div>
{% endblock %}
