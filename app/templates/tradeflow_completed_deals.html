{% extends "base.html" %}
{% block title %}Completed Deals ‚Äì Barter.com{% endblock %}
{% block nav_tradeflow_active %}class="active"{% endblock %}
{% set active_page = 'completed' %}

{% block content %}
<div class="tradeflow-container">
    {% include '_tradeflow_sidebar.html' %}

    <main class="main">
      <div class="page-header">
        <h1 class="page-title">Completed Deals</h1>
        <p class="page-desc">Finished trades with reviews</p>
      </div>
      {% if completed_deals %}
      <div class="cards-grid">
        {% for deal in completed_deals %}
        <div class="card" onclick="location.href='{{ url_for('main.tradeflow_completed_deal_detail', company_id=company.company_id, deal_id=deal.active_deal_id) }}'">
          <div class="card-status">‚úì Completed</div>
          <div class="card-pair">
            <div class="card-side">
              <div class="card-side-label">{{ deal.proposal.from_company.name }}</div>
              <div class="card-side-title">{{ deal.proposal.from_service.title }}</div>
            </div>
            <div class="arrows">‚áÑ</div>
            <div class="card-side">
              <div class="card-side-label">{{ deal.proposal.to_company.name }}</div>
              <div class="card-side-title">{{ deal.proposal.to_service.title }}</div>
            </div>
          </div>
          {% if deal.review %}
          <div class="star-rating">
            {% for i in range(deal.review.rating) %}<span class="star">‚òÖ</span>{% endfor %}{% for i in range(5 - deal.review.rating) %}<span class="star inactive">‚òÖ</span>{% endfor %}
          </div>
          {% endif %}
          <button class="card-button">View Details</button>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="empty">
        <div class="empty-icon">üèÜ</div>
        <div class="empty-text">No completed deals yet</div>
      </div>
      {% endif %}
    </main>
  </div>
{% endblock %}
