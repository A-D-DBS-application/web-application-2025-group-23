{% extends "base.html" %}
{% from 'macros/_review_card.html' import review_card %}
{% block title %}Completed Deal Detail – Barter.com{% endblock %}
{% block nav_tradeflow_active %}class="active"{% endblock %}
{% set active_page = 'completed' %}

{% block content %}
<div class="tradeflow-container">
    {% include '_tradeflow_sidebar.html' %}

    <main class="main">
      <a href="{{ url_for('main.tradeflow_completed_deals', company_id=company.company_id) }}" class="back-link">← Back to Deals</a>
      <div class="detail-card">
        <div class="status-badge completed">✓ Completed</div>
        
        <div class="pair-grid">
          <div class="pair-side">
            <div class="pair-label">{{ proposal.from_service.company.name }} provided</div>
            <div class="pair-service">{{ proposal.from_service.title }}</div>
            <div class="pair-desc">{{ proposal.from_service.description }}</div>
          </div>
          <div class="pair-side">
            <div class="pair-label">{{ proposal.to_service.company.name }} provided</div>
            <div class="pair-service">{{ proposal.to_service.title }}</div>
            <div class="pair-desc">{{ proposal.to_service.description }}</div>
          </div>
        </div>

        {% if reviews %}
        <div class="review-section">
          <div class="review-title">Reviews</div>
          {% for review in reviews %}
            {{ review_card(review, style='tradeflow') }}
          {% endfor %}
        </div>
        {% endif %}

        <div class="review-section-divider">
          <a href="{{ url_for('main.tradeflow_write_review', company_id=company.company_id, deal_id=active_deal.active_deal_id) }}" class="btn-write-review">Write Review</a>
        </div>
      </div>
    </main>
  </div>
{% endblock %}
