<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit service | Barter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-page">
        <div class="app-layout">
            <!-- SIDEBAR -->
            <aside class="app-sidebar">
                <div class="app-sidebar-inner">
                    <div class="app-sidebar-logo">
                        <a href="{{ url_for('main.my_companies') }}">Barter.com</a>
                    </div>
                    
                    <div class="sidebar-profile sidebar-profile--compact">
                        <div class="sidebar-avatar sidebar-avatar--small"></div>
                        <div>
                            <div class="sidebar-user-name sidebar-user-name--small">Hi, {{ username }}</div>
                            <div class="sidebar-user-sub">MY COMPANIES</div>
                        </div>
                    </div>
                    
                    <div class="sidebar-companies">
                        {% for comp in companies %}
                        <button class="sidebar-company-card {% if comp.is_selected %}sidebar-company-card--active{% endif %}"
                                onclick="window.location.href='{{ url_for('main.workspace_overview', company_id=comp.company_id) }}'">
                            <div class="sidebar-company-name">{{ comp.name }}</div>
                            <div class="sidebar-company-meta">{{ comp.member_count }} members • {{ comp.service_count }} services</div>
                            <span class="sidebar-company-role tag">{{ comp.role }}</span>
                        </button>
                        {% endfor %}
                    </div>
                </div>
            </aside>
            
            <!-- MAIN CONTENT -->
            <div class="app-main">
                <header class="app-header">
                    <div class="app-header-content">
                        <div class="app-header-left">
                            <button class="link-back" onclick="window.location.href='{{ url_for('main.workspace_services', company_id=service.company_id) }}'">
                                ← Back to service details
                            </button>
                        </div>
                        <nav class="app-nav">
                            <a href="#" class="app-nav-link">Marketplace</a>
                            <a href="{{ url_for('main.my_companies') }}" class="app-nav-link">My companies</a>
                            <a href="{{ url_for('main.logout') }}" class="app-nav-link">Log out</a>
                        </nav>
                    </div>
                </header>
                
                <main class="app-content">
                    <div class="app-content-inner">
                        {% with messages = get_flashed_messages(with_categories=true) %}
                          {% if messages %}
                            {% for category,msg in messages %}
                              <div class="alert alert-{{ category }}">{{ msg }}</div>
                            {% endfor %}
                          {% endif %}
                        {% endwith %}
                        
                        <div class="form-page-header">
                            <h1 class="form-page-title">Edit service</h1>
                            <p class="form-page-subtitle">Update the details of your service. Changes will be visible in your company workspace and on your public service page.</p>
                        </div>
                        
                        <form method="post" class="standard-form">
                            <div class="form-group">
                                <label for="title" class="form-label">Service title</label>
                                <input type="text" 
                                       id="title" 
                                       name="title" 
                                       class="form-input" 
                                       placeholder="Enter your service title"
                                       value="{{ form_title or '' }}"
                                       required>
                            </div>

                            <div class="form-group">
                                <label for="description" class="form-label">Service description</label>
                                <textarea id="description" 
                                          name="description" 
                                          class="form-textarea" 
                                          rows="5"
                                          placeholder="Describe the service"
                                          required>{{ form_description or '' }}</textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <select name="categories" class="form-select" required>
                                    <option value="">Choose category</option>
                                    {% for cat in categories %}
                                        <option value="{{ cat }}" {% if cat in (form_categories or []) %}selected{% endif %}>{{ cat }}</option>
                                    {% endfor %}
                                </select>
                            </div>

                            <button type="submit" class="btn btn-primary btn-full-width">Save changes</button>
                        </form>
                    </div>
                </main>
            </div>
        </div>
    </div>
</body>
</html>
